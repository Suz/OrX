function mat2 = ArrXMat(array, matrix)%% function for multiplying an array times all the rows of an% appropriately sized (2D) matrix% returns original matrix size and orientation%% SRK 10-2-2004[a1,b1] = size(array);[a2,b2] = size(matrix);ntimes = b2;change = 0;if a1==1 & b1==a2  array = array'; % now a1=a2, b1=1, b2=ntimes  ntimes = b2;elseif a1==1 & b1==b2  ntimes = a2;  array = array'; % now a1>1  matrix = matrix'; % now a1=a2 = multiplication dimension.   [a2,b2] = size(matrix);   change = 1;elseif b1==1 & a1==b2  ntimes = a2;  matrix = matrix'; % now a1=a2   [a2,b2] = size(matrix);  change = 1;elseif a1 ~= (a2 | b2) & b1 ~= (a2 | b2)print('Problem with matrix sizes. No indices match.')end  mat2 = zeros(a2,b2);for i=1:ntimesmat2(:,i) = array.*matrix(:,i);endif change ~=0 mat2 = mat2';end 